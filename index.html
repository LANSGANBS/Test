<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LANSGANBS的网页</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
            background: url('https://t.alcy.cc/ycy') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }
        .clock {
            font-size: 2em;
            font-weight: bold;
        }
        .date {
            font-size: 1.5em;
        }
        .info {
            margin-top: 20px;
            font-size: 1.2em;
        }
        .footer {
            margin-top: 30px;
            font-size: 0.9em;
            color: #888;
        }
        .weather-container {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(10px);
            width: 80%;
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
<h1>欢迎来到LANSGANBS的网页</h1>

<div class="date">
    <p id="date"></p>
</div>

<div class="clock">
    <p id="time"></p>
</div>

<div class="weather-container">
    <h2>当地天气</h2>
    <div id="location">正在获取位置信息...</div>
    <div id="weather">正在获取天气信息...</div>
</div>

<div class="footer">
    <p>感谢访问！</p>
</div>

<script>
  function updateDateTime() {
    const now = new Date();
    const options = { year: 'numeric', month: 'long', day: 'numeric' };
    const formattedDate = now.toLocaleDateString('zh-CN', options);
    const formattedTime = now.toLocaleTimeString('zh-CN');

    document.getElementById('date').textContent = `今天是：${formattedDate}`;
    document.getElementById('time').textContent = `当前时间：${formattedTime}`;
  }

  setInterval(updateDateTime, 1000);
  updateDateTime();

  function getWeatherDescription(code) {
    const weatherCodes = {
      0: '晴朗',
      1: '主要是晴朗',
      2: '部分多云',
      3: '多云',
      45: '有雾',
      48: '沉积物雾',
      51: '细毛毛雨',
      53: '中度毛毛雨',
      55: '密集毛毛雨',
      56: '轻度冻毛毛雨',
      57: '浓密冻毛毛雨',
      61: '小雨',
      63: '中雨',
      65: '大雨',
      66: '轻度冻雨',
      67: '大冻雨',
      71: '小雪',
      73: '中雪',
      75: '大雪',
      77: '雪粒',
      80: '小阵雨',
      81: '中阵雨',
      82: '大阵雨',
      85: '小阵雪',
      86: '大阵雪',
      95: '雷暴',
      96: '轻度冰雹雷暴',
      99: '大冰雹雷暴',
    };
    return weatherCodes[code] || '未知天气';
  }

  function getLocationName(lat, lon) {
    const url = `https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=10&addressdetails=1&accept-language=zh-CN`;

    fetch(url)
    .then(response => response.json())
    .then(data => {
      console.log('位置信息：', data);
      const address = data.address;
      const country = address.country || '';
      const state = address.state || '';
      const city = address.city || address.town || address.village || '';
      const locationDiv = document.getElementById('location');
      locationDiv.textContent = `当前位置：${country}，${state}，${city}`;
    })
    .catch(error => {
      console.error('获取位置信息失败', error);
      document.getElementById('location').textContent = '获取位置信息失败';
    });
  }

  function getWeather(lat, lon) {
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&hourly=temperature_2m&current_weather=true&timezone=Asia%2FShanghai`;

    console.log('请求天气信息的 URL：', url);

    fetch(url)
    .then(response => response.json())
    .then(data => {
      console.log('天气数据：', data);
      if (data.current_weather) {
        const weatherDiv = document.getElementById('weather');
        weatherDiv.innerHTML = `
            <p>温度：${data.current_weather.temperature}°C</p>
            <p>风速：${data.current_weather.windspeed} km/h</p>
            <p>天气：${getWeatherDescription(data.current_weather.weathercode)}</p>
          `;
      } else {
        document.getElementById('weather').textContent = '获取天气信息失败';
      }
    })
    .catch(error => {
      console.error('获取天气信息失败', error);
      document.getElementById('weather').textContent = '获取天气信息失败，请检查控制台以获取更多信息。';
    });
  }

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(position => {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        getLocationName(lat, lon);
        getWeather(lat, lon);
      }, error => {
        console.error('无法获取地理位置信息', error);
        document.getElementById('location').textContent = '无法获取地理位置信息：' + error.message;
        document.getElementById('weather').textContent = '无法获取天气信息';
      });
    } else {
      console.error('浏览器不支持地理定位');
      document.getElementById('location').textContent = '浏览器不支持地理定位';
      document.getElementById('weather').textContent = '无法获取天气信息';
    }
  }

  getLocation();
</script>
</body>
</html>
